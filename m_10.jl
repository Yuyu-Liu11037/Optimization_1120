using JuMP, CPLEX, Distributions, LinearAlgebra

n = 100
m = 10

#very good performance
#=0.03 mu=[45.71647387277958 19.623269506385988 56.622922819477154 16.828171801059565 90.75953175133115 59.197758800965396 9.597008943379793 35.14255821678229 93.83747710645287 53.26727916059348 40.390220683010746 17.02708290646133 73.1734590306994 10.508133643506135 24.814139888215404 87.44236456451601 95.1324088520617 15.680472396354883 17.23118024819573 5.743012413702974 66.94158024147269 62.66737300002519 88.68193559575965 12.537216795290274 2.0626140369382373 84.71917239201085 61.20241884551872 0.87232342737118 56.92819620977551 30.856405315619817 9.985244420311156 64.93201168706551 54.851362741466595 12.340205548584516 19.129546225599224 9.386581820469376 36.45354266532353 64.1535410457916 29.932853716547648 52.031951157589404 66.73986546040096 80.51406679531914 53.42145561972856 30.771696125895033 61.68015444371443 97.12009623906972 53.818319624164225 12.681857600542434 77.14786084123094 82.33201651206443 7.28000213561093 73.1936138673584 50.93955650927031 51.294567585238916 1.5937132736205006 49.85836048996523 80.90030095201166 63.71671922798142 35.734067072012074 60.195354176857094 84.2989320363046 4.698938351779192 57.816421598060195 98.53712750524323 22.607673072052947 11.667455500149583 89.16980829096644 55.878436243232386 69.99029185529244 72.77062991588939 22.69147028959051 76.9019437832107 44.852964712272446 41.327600886432926 2.5506480719886704 52.44326951351529 12.901461046289187 59.577963382073975 20.024300539382565 65.62149743882024 78.34379306601926 41.741085378936695 8.586230062230783 85.08111750453843 67.47965133846502 60.88835682909597 56.61431601158744 86.93069505673368 15.865639393614472 93.54242922305424 15.626108644297599 17.879940175336273 72.71077080855035 49.87476534436885 25.200108057073933 99.51141236958733 29.175157697021316 45.33112557097777 30.60308484861859 54.01332608885136 57.07222312250596 97.95763418701927 66.6856072739307 17.856761394116695 81.96133202139319 87.88028211511111 53.03216933768336 69.66375742817944 65.06607478915308 94.09991438955458]
a=[70.71674667064806 89.39264663257045 6.154271535444744 39.0112632271713 3.397099512969548 2.9560751603587176 28.59611675558307 48.411297711696065 54.283057637681566 27.27948751831998 76.71960091902386 69.54935089396615 23.573349915453857 95.56445411606703 6.85689149078621 22.53196243146084 84.93115497429424 48.77090171020077 43.70115946657287 24.63957057504854 8.588441734911367 17.386393222268993 6.6771935298950424 21.427964622341122 88.80947423389175 95.92179693167783 46.447596705499585 72.25056826458562 74.87278145016836 87.91147032376104 36.02254290307641 25.66124317380025 16.2926761674126 8.03713286051192 94.776829645759 58.918669575253766 44.74887068891198 22.409535335894194 92.64498575284073 54.69682497300724 44.07330664612223 99.60267748191644 11.924379776531113 45.21077159031722 6.478662667248358 67.49056032749317 8.36092024560725 92.19889708335947 90.64769013350359 25.179613682408675 0.49343910379949785 30.790171206083716 86.72594923998929 76.95407993932271 43.65636491411936 3.285554506383348 36.70812252980309 53.89029407661909 35.7525820937024 91.96316080507508 26.182677821182832 79.85869974187246 55.640440225129815 67.98061441283647 79.48297522008592 41.93136356732702 61.84949653688455 79.88287509870597 42.29494013045534 35.16201501119603 12.586612434089329 29.24547574842681 98.05425092842597 59.222080351678294 82.6233204990651 32.29163635784883 97.98951867148331 4.891473567245541 30.180173849044223 49.59443644721483 95.95570492377833 58.05368468363676 42.81996013179133 89.42303374502036 94.39886864480546 12.459783155622917 77.29871204806722 26.7813867547965 40.11562784513224 49.250169722282834 26.54800430089925 30.091430852545475 58.20032443288935 76.72961997566297 17.409722350241196 69.1512983222172 40.17498914621452 69.99463065319443 64.65626063501773 79.80855789014105 31.495995213833773 38.5597516112955 77.86183093332035 12.506119999848963 42.193765612435975 25.350340535970872 32.54178233352869 67.47312852670558 79.99855210392982 31.53950424643717]
b=2709.3571334758267
sigma=[43.08894771465781, 1.2380938181466237, 45.79832603377481, 6.5441477192226865, 8.641616033163018, 14.762462263329809, 2.0168725622181896, 12.592890962689587, 34.36813020589832, 39.73392202571715, 18.403863051469997, 15.286160418949656, 55.87937363276698, 7.066333688462145, 20.588985079348404, 63.165672653177545, 77.0779177754916, 14.29057786637271, 7.021130110162105, 5.232350531485729, 40.47801335856857, 15.651024881592626, 8.942627634244037, 5.00793592350551, 0.21568744569527168, 10.422708035495353, 16.0702284864246, 0.7840936716920022, 7.311652162979928, 9.231315437233466, 2.127473560732954, 34.82852487406975, 47.485590328886154, 10.199081968905716, 0.5178919106427817, 3.8913815140516075, 13.978333829084717, 26.673271234728286, 28.026779050688702, 5.3337011710062034, 41.06681007855365, 12.065723648725031, 25.433028110532856, 4.839834913011375, 44.405767190268236, 85.59338156756073, 34.49460938082437, 1.9722135810636883, 38.86901980018326, 32.35931073405814, 6.854728792461846, 6.445396003989431, 13.49423591200615, 41.93449454847227, 1.1906807896813096, 17.52049621985322, 65.05094703181798, 9.021311010487764, 32.70110566737545, 12.566980075475922, 61.52258650038582, 0.6493863585023171, 49.463112613862506, 48.44761980773616, 16.36531745759051, 3.9942454524435087, 55.35800506190335, 25.64595693930364, 65.64855386012752, 39.82268531943133, 21.989739871357596, 3.265333188404226, 10.792842857510605, 24.14706987083852, 0.5853900613119283, 37.61437929029982, 1.846828620346277, 49.26992580379473, 11.69431202102993, 35.31639254170048, 47.19805635647439, 11.709950331138998, 7.5534849388231216, 8.59481178637709, 6.603329280084429, 39.582446144653005, 50.979818127503314, 70.87244021540077, 10.874235149119869, 87.23543714390182, 0.9045875674237414, 15.75201447491936, 57.6411091890586, 41.00371253489228, 5.355956829622836, 83.10506553866749, 3.950374275027619, 22.49643207231421, 17.273657102948924, 49.66367136839146, 54.65197961758336, 94.04854157947523, 61.731684401845726, 15.309833862863705, 15.248072885888147, 38.6001207239093, 23.165489351023787, 38.86636326160849, 29.17997414629514, 91.95447129192605]
 =#  
#=  mu=[2.5803945165043696 44.93329037516963 37.43689697769147 54.36985843309675 68.99914959610763 4.980090418500682 33.13636141182634 83.64075297314966 81.0676639022636 81.05384712929741 84.48113052551672 10.249329953339725 33.156297076165465 66.84050468179619 13.141067142630892 40.90001486788677 79.60732610437613 23.285608361224007 43.882266292618986 37.05157152787334 7.23554738122928 68.58893889634274 37.32776327210235 67.1103218315999 58.37174921017113 13.969561137140706 22.8116215649134 38.34526125427622 40.56805626131372 29.970356711950853 94.9319749276812 56.577957122436715 86.57920121011608 53.80689388413592 23.012650458224382 4.02793288948372 48.07104412439135 98.86711688441287 19.232798125320883 41.13996794779226 29.253663289332763 40.91475622545874 43.434024347823495 21.815169889015408 60.5239346011959 5.404109382511568 32.10287425822024 18.66129381528173 57.270339465111086 76.42880782883569 17.912558537619518 49.46738405833084 24.59302775242671 61.73414626265712 99.08459891188085 40.90880916434932 57.80727427365993 20.68300360130131 85.73329556491993 86.58373215873756 80.1518540197657 69.02617375872303 39.470953585323684 51.126266522952 23.7100319104807 67.54429666920319 78.82326219367512 29.94779597270628 37.95014415519028 43.65824674417086 89.73361734819089 58.90427823870483 73.84467538049908 78.14360132104808 22.566437118933536 15.03223241270949 14.28921813100893 55.204745827261256 21.777235689225417 76.04115305639495 26.51037044322493 3.409857760428414 61.580618271418395 34.69850404190261 63.40727607441924 83.9014483068921 88.9477371469704 83.29287870621178 30.326336461068927 64.2066375692477 99.04973892378277 31.949305311177213 19.80502942257736 21.659007157935417 51.83014309200157 71.13120932151665 89.99736989077289 79.00566612551138 40.6457728456857 99.24290813151075 40.28753089691354 24.029707026153492 94.25011550540312 36.78652707005594 86.67262907035469 22.780992608780657 97.85659656786086 58.765972470575335 41.117372938380825 74.24151456474027]
 a=[74.87851050178287 93.23133822768858 92.71998689172702 65.81913963366299 6.900575147418708 71.79794253741693 6.960888449431623 50.58750794953703 41.57580450315332 22.856168312952583 57.81090527532313 56.02490944483105 67.63531109944918 19.405256521552783 58.37506979587109 78.20663659346113 84.0590826886029 71.18503212262569 85.90569852024481 18.322096969225264 82.8331277905888 90.86942277797154 38.778933164136994 0.4375508165004316 91.29674498604902 26.44821493060472 69.1060979380456 66.7696746591372 2.8671565857439574 15.862226837186155 92.69258415302593 33.57432154170695 6.398896966407341 59.49741315518943 84.35816991332258 51.21653268011257 34.694795388376356 52.29555781740245 57.06736909700341 52.97980862084978 55.1247646504178 84.7785469773105 89.62878668442545 83.67384365737861 49.60643584955502 32.17317522220897 46.32523320892621 23.872328761888305 12.291069224922314 76.83221530672995 18.240806437055056 47.199521402661816 76.52579923001946 86.9627074031204 11.689417605181884 83.27421225407224 96.02790005657911 64.04124824549598 30.768405066453177 76.23360898418835 20.227404025528074 55.060434804536875 77.50928906131452 70.93079780199028 5.365843854019092 84.47540274700513 57.44941871917033 90.05688279500971 60.49722871558289 85.914471714063 70.95165108939474 54.391469928940026 40.82538043557455 77.95961826895028 62.61934218036852 59.35380782296773 85.11344692997743 3.3575628988607997 3.993611796937546 72.1622746949149 49.47109559646228 93.67265690755333 38.3046196181262 2.3965536591608383 39.18218008084835 14.865387498611993 62.237646265588076 73.96351408430817 37.1679036230421 42.94818217331448 33.65261874554677 16.231891456329816 72.26297641105978 10.170165851135927 96.64171633077686 42.55921036748831 10.811290097351634 17.813525374575146 59.91457562688672 18.542226643665327 46.670189882723236 45.784741305992114 4.027079608277429 20.292731941034315 14.63769411605983 68.7090893525499 10.051140887594945 37.3046185218188 63.475660954294945 55.139868070535734]
 b=2808.3452892858654
 sigma=[0.8196941152896077, 23.02793352614637, 25.740222541197678, 3.166407458776928, 49.76567154897269, 1.7396950686874197, 26.24481526118061, 42.37065518731536, 45.08889492113889, 23.32435151902847, 0.1631280614449197, 7.42698194955992, 3.6692344303068567, 19.83093071447527, 2.2023595547637216, 31.863623446141514, 22.562689605478372, 14.676801693561522, 0.11768101050470968, 32.57317961446135, 6.2671236030532205, 19.93046719995164, 13.33263561766109, 50.50695963761871, 51.44416534097768, 9.46236859151966, 13.697906679997265, 12.67749826913553, 33.905097121930126, 4.078280353073438, 6.9942673549844985, 12.97332430433447, 7.44512952662268, 5.341443666014263, 6.617898452972944, 1.615862276047821, 38.948133748950056, 0.30585885246719446, 5.497429323127338, 40.52549216812451, 24.039075354628984, 34.45268751420173, 14.477099107429208, 6.459259446545221, 38.12175893921119, 5.096177190006676, 21.441462086834775, 17.223329805038325, 48.133386772601526, 50.14379247240165, 15.675079295074536, 48.872967785986965, 1.273215188843438, 45.28310968731902, 65.99662678482689, 28.64343178880534, 16.361270413252146, 11.668298222434249, 8.900302364703453, 16.85301924874882, 46.673993854602415, 43.66381682927775, 8.76468378276029, 8.492808372492357, 5.73732406471958, 64.65393593364163, 23.665159700813337, 1.0976278945096445, 4.355180463814287, 34.07008730248012, 13.96194150025797, 55.23494473849868, 62.78350370478358, 74.47982250602531, 6.946287605290166, 2.174296818077027, 7.982373116067907, 20.307034940014976, 0.778797450185024, 28.728988550694737, 6.898364985077227, 0.2925695963702807, 61.26889469158567, 33.44855188835869, 11.09405167347995, 69.04365290740272, 57.63229811847328, 45.309987213124735, 15.850130576259328, 17.385077686799775, 7.927275064940429, 10.423652640279295, 0.11706191877009293, 2.8460490365486817, 48.334574402972784, 4.9491333699522375, 45.64550997872988, 47.32081339304926, 33.2483927178106, 33.62733571702298, 13.28257348822441, 12.198214316148825, 88.92445312939893, 13.605489122712546, 17.28705451446582, 19.463323504254756, 31.854330091832587, 34.50290537354833, 39.33257539290856, 42.19826647256036]
  =#
  mu=[83.09205559925192 20.14619899972744 15.999629728643072 74.34302435905094 19.567161513089314 99.85540596818825 96.6440218441089 96.31961971426314 83.37652823329626 82.02729415029515 8.903874540847035 20.925819191681573 6.304410662313997 74.90562557743715 70.72583948355134 17.453086412302532 65.88388320113746 5.972765068172203 64.68543982185871 44.80283341138047 34.87729338248653 35.02251687726814 93.45812005654672 27.122040173306928 50.498851141542566 13.115604692068672 73.07470544362421 35.32800073086907 88.49987811233585 87.63732472655525 74.33892389844056 97.08296994338119 31.626479725839097 5.895782113484971 94.35440172223036 90.0477596370582 27.838634811907237 32.055720368507544 58.884780223672706 5.572236747236092 95.3231969554463 0.36033938763886386 67.86754059836126 61.48118408612654 65.4891218863798 45.277719681545584 18.370435634958472 39.27489575692486 88.17801796908009 97.51501185547912 1.321361883503125 24.897205622808826 99.78435721066735 33.44746826840613 22.0428309410474 27.474989330943355 36.87401494672176 20.687112436824005 39.81970138694256 29.523368757143476 93.3894888049713 58.60581582258704 50.76650287353488 42.026053422368705 93.015774681532 88.46990441521788 51.02834476617918 57.323904340357444 37.80292162259882 65.12445826732997 86.36030227466966 44.10318585594328 45.99792483549599 93.11170222747779 49.36298079977862 43.88662289703411 11.615299698473613 22.293283862618484 43.245464556881416 66.61949701244122 69.66439931731495 25.971307786051977 70.73724693800216 81.0340293036835 41.36947291847196 19.83023173319366 5.805855573509433 35.852998620039166 48.02455832567887 89.50628950888478 72.8017235325686 42.90512691236535 0.8164367466408362 24.79461383839362 78.34552866064826 87.35390998489856 70.94704286690596 38.707633295878296 77.92996505927609 80.32710656752296 40.381864941817454 91.78211465450971 31.629569430471992 83.71078648587856 49.40343077086842 24.668104403914615 8.5792081621351 82.16829822095202 59.1687719854446 50.961936057247904]
  a=[46.985179084429504 11.986693083851085 20.844800081548843 62.71927637203092 50.852666721578096 23.362006208210275 34.69196177212323 92.10115208393836 85.41692325865122 37.0109670321764 38.29124731833461 52.14470166460568 81.38020491129943 4.433325381460474 16.431059271621262 75.24169345306187 65.10892553879209 40.629915945394615 90.89825110017959 75.99444212066467 31.081175651401615 10.60285648134397 81.39078275355139 74.25719222033506 80.93563066793683 3.5431904672471703 10.311811136245918 53.42618263485529 59.228863203781266 42.983764941972225 99.75355203300033 18.386652387617865 52.444963286740546 66.48541409840257 1.017305695659243 58.958426833644474 72.98767228084392 1.249688804740945 50.391150146651384 97.73184169060376 71.6721062977154 60.912433816574286 38.811270830686105 70.79205272937597 63.39024171948316 66.8590229929298 96.5043253605501 18.353414378003187 97.0225938166638 26.36458247943968 22.33567375498302 76.89185154973858 9.262922751933289 17.51533546971992 27.768953207963055 15.161941513670573 56.49604904748625 32.683236436480655 44.87802626150458 4.331572310577303 81.67010428909435 21.631219075779317 51.580018546675156 90.07385787956682 14.289983237150494 32.047113216455934 55.26815353478587 56.60004743676596 25.768150067690854 56.08376113768946 39.55768515007414 59.761066980655706 4.657241951412317 86.36795215482611 49.51550435859182 98.80194437056153 58.21790515231176 90.29035590967844 83.5992438065169 3.0018326138659845 97.87913668153786 21.41101558250762 33.53744708682226 89.99720318295248 9.088217102558904 13.854249084761971 69.3972008354932 12.720726958189355 56.12025424696982 7.722192320864451 51.46986293717538 93.29907605425188 9.648327068940322 58.73024055214094 16.18008918425875 0.660297678440791 10.196328953193712 3.56680711097479 26.538005752448115 24.149834681490812 30.866649915606992 54.45120839574938 77.3747688891801 97.86014421844106 27.11820889529418 49.16861580505739 96.92492630998416 30.03076286186953 14.327228616958909 3.905868320924011]
  b=2569.3395763505973
  sigma=[68.57162880843815, 6.517491323921962, 10.442341255508296, 29.45092174346329, 7.972373169104754, 67.15976926119781, 59.81211826724379, 20.022005858238693, 63.16670304484237, 5.3667675250573526, 0.8540102694891571, 18.385623681300807, 4.3113097107734815, 47.730271960893795, 15.50463186019617, 17.043763307996482, 6.045956870668331, 5.387433488397819, 48.39080717360607, 12.721073439941199, 18.78667648096671, 27.147247770296765, 80.71753954007247, 18.04914740150733, 11.015080636427607, 6.252948397885532, 8.141714385279345, 18.21147697296982, 73.2793373887968, 61.04449560273146, 40.28377434730351, 30.257091133277118, 22.91922521371884, 1.229987286246495, 85.72282650332987, 38.45458896543819, 10.969680936624066, 2.726511405948786, 58.00085589154239, 0.9700441175908574, 64.47853199973902, 0.340978384580995, 52.337042734201496, 48.6062784081993, 32.821741723961225, 18.352904888680026, 6.707540289325013, 22.310995300478282, 42.42604393037605, 52.62203878387636, 0.3758911725137508, 0.2994475978600505, 11.899468459261307, 11.996947262879575, 9.76145553267894, 8.551629788868023, 17.825201129327322, 14.945342987839341, 37.2151587757661, 11.890976667493375, 3.6036960411931376, 9.461829119062006, 18.47907257618378, 35.757164613548326, 14.133946680071027, 55.44745029384055, 45.14307169042162, 40.03347282317019, 9.408962761024066, 22.286819517701332, 29.07125274992057, 17.747926617497598, 28.66225030471637, 9.917111549684735, 25.53586296718013, 37.043660138412775, 4.078473707185989, 3.1276024731135954, 15.548292212052854, 34.03673360518685, 62.305644959154264, 9.541637294624858, 55.37930072496348, 12.06957476435424, 28.225892588184372, 15.079271593815871, 0.1373867553217474, 23.171285819658397, 47.70859871116184, 52.20372501973269, 32.53965824689922, 12.88187581306314, 0.6814420869355657, 24.516205454883995, 65.54796381676933, 78.8849320777254, 4.726235571351146, 9.795094743313513, 24.769111197196334, 62.063560647818804, 2.0297885193023895, 76.28152750743929, 10.150653770970873, 42.051399255675584, 29.878460712051965, 20.973199739518638, 3.4920200673934354, 25.723546377337232, 29.507554145396256, 3.985343452946898]
 
 
    #epsilon=0.05
Omega=4.358898943540673


model = Model(optimizer_with_attributes(CPLEX.Optimizer, "CPXPARAM_MIP_Strategy_HeuristicEffort" => 0 , "CPXPARAM_MIP_Strategy_Search" => 1, "CPX_PARAM_CUTSFACTOR" => 1 , "CPXPARAM_Preprocessing_Linear" => 0 , "CPXPARAM_MIP_Interval" => 1))
MOI.set(model, MOI.NumberOfThreads(), 1)
@variable(model, x[1:n] , Bin)
@variable(model, 0<= y[1:m] <= 1)
@variable(model, c >= 0)
@objective(model, Max, sum(mu[i] * x[i] for i in (1:n)') + sum(mu[100+i] * y[i] for i in (1:m)') - Omega * c)
@constraint(model, sum(a[i] * x[i] for i in (1:n)') + sum(a[100+i] * y[i] for i in (1:m)') <= b)
@constraint(model, c^2 >= sum(sigma[i]^2 * x[i]^2 for i in (1:n)') + sum(sigma[i+n]^2 * y[i]^2 for i in (1:m)'))

optimize!(model)
print("f = " , objective_value(model))