using JuMP, CPLEX, Distributions, LinearAlgebra

n = 100
m = 20

#=
0.02&0.03 mu=[20.513842722498012 56.03329932875505 3.3520698951290284 88.63569444630308 53.80973759182186 99.8659702380808 88.2812628540325 61.49017232075873 51.50883167721626 71.01442255737491 46.54249405677417 78.19211371244347 49.984339288585346 54.27789143979079 68.18887475006021 89.66195218694486 15.165830034615402 43.58121402270648 49.082853308986785 30.526736629812532 72.61947920697827 92.01296563424862 56.98053871991991 76.8039905684266 32.851386808386884 45.153307845322956 32.18100474809737 26.939916312833446 50.51134609245768 33.945015195083215 6.099359490162803 98.53746496429763 51.08986190303179 57.48283537106151 47.54476933921673 93.72031072512348 78.12059024370348 29.518578108287088 3.324751653647684 84.74359112106575 57.31700672315644 27.244886830948623 16.558826262358618 22.416612581612128 91.76102554675127 44.59153306959177 52.76000726769453 26.65956307050642 11.463516161789167 59.76919795018164 93.40789557869664 74.54687588185297 46.212118703647576 5.213953417095385 90.70899224119292 42.440156804335224 68.37883334269861 0.06634306652341104 61.41842518128924 51.596879385880825 42.77266968110045 79.41227019350585 38.541534241664166 77.75671179742258 67.34441804896747 43.20689496789394 91.2531685696558 69.13852892215084 97.10260799598421 0.6321404596257518 16.885333157275497 48.47246436491998 44.524446647275894 59.539382565923084 23.42649578870918 62.31199843126074 49.770970436796844 68.25722218689707 5.63518065278954 12.588108382658325 69.90751855059914 80.1390053024299 15.894711984404175 44.5885280073359 63.50773367483635 99.26618789385118 75.62883400965693 33.07017458042092 12.242932984027565 55.87307681500887 46.74355450053162 92.08947542553089 84.4452052401994 64.04537762126587 10.812584472903652 66.53407066283486 93.70376892289565 60.26516559523376 48.80048935406168 11.718415340873134 61.14291004694289 21.17574503758144 4.077858009213875 51.35833478523257 84.72745188700704 35.07318543388034 32.91112562960345 79.89506976041602 44.14773115030003 38.958370582680736 44.92158987070232 53.58976313541882 42.743464961267144 57.457466085884256 62.47320529198538 93.15953325457983 57.86906096027958 99.2211798243191 21.688157968118492 53.40578338362607]
a=[25.51154416572945 34.89659036825445 47.00365418061988 45.85525725941883 97.09201244202563 17.552070421356024 56.25413455434797 63.00488796678781 32.35987554275449 0.5158874521252299 80.39242036728506 17.116779150378967 54.783726558991866 48.184264760415 36.88282111412946 43.166782576395015 69.90162554112182 72.1306174287958 31.3324139133903 49.38825142897958 0.8136450376776461 8.291970896083233 97.56775857405782 22.117485370955503 8.526445662853533 9.259693840507966 68.8089246695641 26.51533712766009 39.98797002783745 66.34045881436712 51.12820454229945 79.21924843036048 20.73301411340146 24.96336768508599 26.08973138183517 8.322301005666088 24.35632434867476 68.6987632407725 83.48056898304516 65.83207224339819 16.382223574689114 43.03972046883637 55.36565739475575 30.125149675919495 65.28462127906836 52.52533333463057 7.864399307430292 33.28460985103613 83.72590257096671 85.65256385999508 61.08597583257338 65.1315179116688 57.08571998146065 27.97656952375023 56.768892322378605 85.5954116658281 7.457628070499234 9.033506925733315 69.65619383454231 58.351225699058226 12.512999400976021 53.926851797151635 85.65365872985276 74.04412672870852 58.986747537035235 95.27365081575438 62.027844582777256 72.25076062073978 98.35462863519935 41.13584554035147 33.45136435765501 75.88848309821849 35.55556765732679 89.58479525289171 67.4257448368274 65.5242511328686 13.354012378656154 12.625353805793305 29.648012367488576 19.187145686616248 51.96978712263115 85.92331967057994 22.566968035830392 6.67451705350004 17.094560525193813 42.49118287662099 81.3930515518101 31.31736115060385 47.977701521839975 40.03209909198444 39.45307263821931 41.00243240724835 59.066202465524306 1.5318936402002548 55.564919307126544 92.44483838186311 85.52108034472622 6.027226769757044 9.661422432930467 10.59816695225143 15.333951146183367 86.20807765087243 2.4662590961609943 44.90999755660421 2.364243227848306 31.12152619114322 82.0198483550363 65.45100127167338 99.81104013942506 87.8394515336524 36.70822139736122 66.70567768392766 42.36181332354141 44.5904998821521 13.885622613640901 85.16594493594027 17.142295319343724 65.31378316090765 81.47841215011009 14.853561880188614]
b=2803.1133018466357
sigma=[7.5384912517672396, 8.803029003254125, 3.3451908604401623, 71.93197178265743, 31.954969071026593, 44.65233801253968, 39.76287203073942, 0.4050303059179727, 0.9946327920515023, 34.556528174114874, 39.25240605278294, 70.6491386433148, 37.05457779093648, 37.77644622922939, 14.256306285049469, 36.36371784665085, 8.383141632265172, 4.090207803031838, 0.9651836631610212, 11.378314650077288, 5.813988337977769, 89.58906176599362, 53.04232156365612, 9.074004253812907, 11.525771994929267, 41.084827766617046, 8.560207816922404, 11.756551061978179, 14.405367676588197, 18.736342821619502, 2.065851178833618, 86.41001891674374, 48.922649882285846, 39.52334496636609, 30.76801897244749, 27.919957713061795, 6.838704754173737, 26.075285006326297, 1.9355630289175947, 59.6486660807408, 55.27874995980808, 8.472377669938158, 7.768956102134669, 5.362013327292108, 85.38377948385845, 12.601905545631212, 18.209686718892144, 9.861073497758005, 9.964412311347663, 46.71608846767383, 29.66951269365241, 55.821408158525706, 34.72350235134834, 4.4994274861260175, 85.75403198044873, 37.59835275460666, 36.84466916061071, 0.05911491069182574, 27.258675527215406, 0.4279117055153698, 0.08370284442667471, 45.233189618370325, 37.94354394544579, 64.22457841375095, 4.5979476690223615, 7.093093002121527, 59.89062622406086, 29.980333381983627, 88.66142030292669, 0.0008689420303889904, 11.427952864616403, 45.04383451459703, 4.396774922569215, 8.322159621363419, 7.628750800712995, 36.06247914081309, 24.44073576897365, 21.315085477080178, 0.7860247059012027, 11.684986771067843, 45.342888306681054, 49.55249130970645, 8.503437470701394, 42.54498247725002, 23.52795373782089, 25.3051920135618, 16.282354346015328, 7.824905229368805, 0.32453481211850316, 21.463566105644883, 21.212861934638497, 10.651063567226844, 83.05863011104243, 25.936365554397675, 10.669074239509479, 23.479837060489587, 45.56470222458566, 29.838382533686726, 21.345423581241988, 10.723820506241406, 55.68813367305635, 0.7078495603701515, 3.9752277871265793, 22.61088280591991, 62.24136939076308, 6.760943160291815, 14.570913653543052, 37.892402162816225, 23.87016787635257, 21.651725070368965, 34.39411142609425, 46.518267307204766, 20.824721195933716, 45.30198949035004, 29.626960580120095, 28.963583876787947, 55.66876453092729, 1.198311732049557, 17.854967153574226, 38.58665961433615]
 =#
#=0.05 mu=[36.38974464333587 19.876926845066922 30.62600605509327 42.49006044013023 12.460354256925378 13.088730345319854 61.51540953439007 82.3199877023475 24.296437023987462 73.78067333248381 23.15793089584368 60.466191545633905 52.83338763987562 16.763406135441517 33.377265340160264 63.081220449233456 69.02403331358516 87.83362314230624 62.716582675572226 90.66565497270062 90.54187943564577 5.297462719629342 91.43935808786372 16.555838616259788 96.38029932259798 38.94140802229842 82.94118309616042 32.39357024837734 43.84103621459746 28.143847463471296 87.17267089913318 76.57140526395168 29.07012804673631 66.00720071665269 29.033003159469494 98.57280076985252 76.26579072424178 41.695176929884845 58.234841830843486 51.03434891619446 49.706962031618964 93.15710568930261 53.18425083995412 28.85323784475914 95.2492701156642 99.44081024888351 93.9681673470406 56.391095339584574 67.70305484972432 72.41011981130093 31.71866484850253 32.04052845546298 26.679001308160377 87.49800515134464 67.22862015523665 16.64621879073063 54.5340065591044 31.999114922581906 73.49586182611743 56.36925780198825 80.68422001176117 12.33919168623836 16.564961358475884 58.82953569166332 7.710040444038057 19.10914749035414 17.413140593999067 39.70916229415409 39.21799756225537 81.45631951038321 15.267918727646467 34.66475220112053 83.82265825528184 90.12628511358709 90.6647684111779 22.613472549488822 85.83663537794756 91.38148254396245 74.74211270135112 60.907798063544504 96.11220324860548 46.36045920803388 40.24684497178866 28.29172980492556 42.67611975134482 70.58001156853696 30.881339768409532 59.68820211218014 97.32070625256262 91.654390116174 29.885404193090658 49.02621770597306 26.012202530068716 2.1594958543439735 12.98061858734294 24.854115959319543 45.62377968313223 82.26322398413288 36.78499556752075 70.59886986547171 64.95161182338998 59.7805872173255 19.59198863137305 66.92319775384924 31.22450910043063 75.61871472413837 99.5791981590086 26.01413400795376 56.34485649180261 0.008459526256721084 49.4053289356161 8.628663972552165 87.70670977594392 84.68302618396505 94.29661628884914 90.75628007555422 93.16991420794 85.33482222664479 82.48180203232721 26.82566184184234]
a=[91.98104916375567 73.12011960208832 48.33370178120728 16.949257048758692 89.16394967263463 21.5511728041922 78.68399474572078 78.43666838426506 92.80931496740796 13.671487498968983 66.93815359093472 17.48975846791406 85.22810528197489 53.52207683391336 68.10068147574513 74.84175489227994 34.53013107450711 40.105585677023505 65.47462821610571 34.98800779672441 83.81638591154423 26.758895367208947 94.50383470338589 96.80716019902539 72.95648632750294 65.5490465462534 78.65513788124414 35.14400593503505 89.90392848838167 68.9456839793535 80.18733883919703 20.535970294676908 67.77656985885717 82.21954366116239 41.502629548070516 60.98712635833768 81.06822783580726 25.072265520502015 7.54769089207219 21.10008544888715 25.96537369740434 78.60696785123834 58.598662260954285 81.53259172767957 19.053632818672018 76.22143733335452 79.1081694255626 7.185387275372634 23.167242285373646 2.1281228492460835 27.580193178187685 13.807767520960546 46.51438082261424 42.10106940621344 6.74979422735219 14.258361671036345 6.020144193684951 50.639256523264585 76.09298888949687 46.955219952886296 81.40773703940106 19.194239789100852 19.699513863935035 21.238913719329886 86.3988818060195 51.197067495715 34.35355760568831 23.656567514823813 76.00382452825582 39.68621906979985 1.2775671712309866 18.552165193702642 8.595142246346343 16.474632201906836 46.74665996108492 82.61232769416043 57.85473796883802 81.10847171396777 32.05495415151377 29.44043070945337 20.073525309383232 86.43266907245301 51.656656989316794 11.377736620262391 95.71675775626665 63.44333138807631 20.977599598841778 12.625853554516475 30.584104002856826 57.001837990549454 83.54904240311622 80.18144896460512 75.47796080325494 63.61013288804088 14.634601452645835 30.086304755595695 85.48635799695182 78.85673417218062 56.02838579719578 82.8962667320721 60.41717053905333 44.74976643339593 87.08219749576993 60.944678530022614 92.9146745283564 11.552304466681695 79.83708747570556 26.663103249007637 69.51668272244068 63.89871429977002 65.88006433354543 81.69767563031179 39.12282911686662 54.437068026144416 65.26529185913802 62.056727529204224 64.15899504189298 68.69652247460176 40.86677123668636 60.29965309497835]
b=3128.7766371296066
sigma=[17.99443839523841, 14.8939477084975, 30.283137108043167, 8.46106373094008, 3.6833922046089587, 1.5117929446071927, 18.228512849747734, 37.1178797515717, 1.2660900782864808, 28.885751277102592, 22.630088728789723, 34.93669488405136, 0.8691672679720766, 7.740325047952688, 12.400476621208332, 12.988302745191623, 7.003287562843322, 47.21029224975305, 21.302220171553916, 45.88640963807119, 18.527583620165988, 1.588884630675805, 45.1655047244865, 9.650932399419801, 32.84413608885397, 21.430932853542537, 41.32992843119956, 5.072346587843006, 20.33147864637533, 11.465394147480295, 43.41589598517251, 45.975835740373924, 15.738221666520028, 5.412496136523433, 11.973423884269806, 35.584777269626514, 25.416122712959098, 7.968026357780788, 48.21732424235781, 32.93805254232851, 32.98613136363277, 58.78875161780993, 3.1936753430284264, 8.732986182279237, 31.08151165306303, 66.62658722508196, 64.88004203920859, 10.447376898510976, 26.478074022115525, 8.957849725052748, 25.368790218727383, 19.959225971539976, 17.203226757304726, 55.76187187877537, 18.5655498657517, 2.37721459594105, 41.517924568698334, 29.595879942124725, 8.416106287856076, 14.217103922667565, 6.570073608674803, 2.5618927645880065, 1.1840396037497123, 20.392087279263656, 6.816775063504967, 16.624023304245707, 8.498983976016959, 3.562091420968708, 28.06540338515044, 60.29029642110918, 4.112270499586167, 28.289267456577328, 48.59432254554472, 20.7751035761213, 0.1799873391405776, 0.027571134066690428, 77.21799314666758, 26.42227606607485, 46.20645000903212, 55.79892551985867, 5.2862800597714035, 23.20128840226402, 24.385226702857942, 0.10851699427645983, 24.869649323513276, 61.27175142994754, 0.9651282649417202, 21.62962317938915, 65.10655978281456, 85.44099280534064, 6.519466164361924, 31.35604299506938, 8.138478247917044, 0.1277401412947178, 10.697311049870775, 0.368842842146344, 37.671096980142806, 1.218095167618139, 1.6511213995124436, 17.9811560091945, 61.77735136221031, 46.13911997133135, 2.85897338049741, 42.186263771993495, 20.365745720104947, 57.97844811731086, 28.391600340305278, 16.207000674826837, 22.86033094673412, 0.006818064048612271, 29.880005856876622, 3.4762416929723186, 76.85501697030408, 81.74818310493256, 33.017077797473554, 17.68227354728424, 18.84497871777818, 55.56023049854665, 7.676198566468982, 14.609286138661375]
 =#
mu=[94.76383715123572 33.23043588583412 54.69886833778017 1.8102648236075103 17.602943494470747 42.45315984540249 23.113349674450102 12.916735092914887 17.149123104125806 49.395438804069016 40.16291028139308 3.5886604414051004 24.947956307433827 96.38705728106778 37.78085168201988 30.63070469447916 49.98929908240013 15.301570275737475 91.93836126341604 6.026907088580547 67.95194309873422 29.291073816269318 49.51441900854909 25.79215096786661 10.050937432624728 36.14127180796677 44.292653678525554 59.28275169405437 51.15092572942713 90.32564261722386 30.050898329301866 21.760020161009706 25.119856524276674 16.319016961473697 46.80474714658348 39.036321464716764 91.98134633786792 13.326075430306295 84.13341347567341 34.08189911365661 78.9948830410087 49.335693145967106 23.967383417847365 37.048067203771716 1.8478568693371167 25.848547374348275 24.67764163210543 23.537839908535872 10.415111621842254 33.778874754487255 34.817002475555235 32.85099602779192 0.08423756301806362 79.71743325402288 20.808076621964688 41.638048508340354 73.74708941344763 28.46249575947023 99.7375360630426 66.10054719498287 95.80180100696208 93.56841238357038 36.190991921427 66.19491151001235 21.323481165134773 69.06512898956333 90.44088822255122 69.13364035829028 14.197341549220289 18.87376174783163 56.277604036332654 44.99192412978337 27.205542755825473 59.43104533069422 10.870245332969796 52.36328270456953 3.149734913975133 75.87955447957503 76.81626983344115 55.00741638970007 90.98512218715312 51.83459143791589 99.70512923440975 68.57461856290332 9.844507754933684 93.08496004719751 35.00053415758347 36.376579702165614 77.49443824205632 51.04604264824164 20.75247476363079 31.997627298886233 25.330634571128485 47.944851361166606 62.625798319030125 99.90292830227483 12.49113156474122 88.28169798455725 40.271729295326594 59.074070423602365 34.17481276746178 26.43287719626337 84.96759039419904 79.93803723681295 2.9172092168409325 70.06403562926315 95.03808495140946 2.655899168099729 23.649972663832408 15.457793913379925 9.128049041730568 61.129795637616354 92.91188704842016 10.001138342454164 62.531642589561166 54.38265920570422 20.76210060667475 86.80239449997691 67.79750130710144 87.46015476594042]
a=[31.386036632177582 63.655737265939784 66.87389398998167 32.196926402158866 18.173987691634153 85.36144865442336 35.934921569035616 94.93576419353865 92.52776891335209 91.57106323400865 10.54730972247626 71.9889859188689 78.77740404351742 65.63319505703159 68.95700869565854 52.42942720426276 62.332815421845076 58.67382045817789 70.48969436142724 59.36413209242903 44.81422309697602 12.494426001099178 67.61258669457018 80.07761067787081 59.557452041930226 21.8729813071164 81.54233502653967 92.00092550648799 49.531205757979095 89.33133956017768 6.133659207015207 76.02427279187576 90.7124286989904 97.11806426038837 83.33893860261405 52.97127044814896 48.786822286859234 85.1953214978682 35.27716228661228 41.273688523901576 19.753498695348526 28.79722020644604 13.859560910144086 56.151009310516166 27.321842716109114 15.00989347104702 57.01122761048059 18.201575444874273 64.28385560047288 88.04636964478519 35.82173397776005 40.18990281768321 97.49135619260645 4.544679393411655 59.77713489285333 97.81922465208447 98.42061759399895 53.66802620955484 71.58722962637331 43.3282755700884 50.04105582040669 52.08404463914233 5.623388582855338 42.25259729157985 90.27774351519957 4.737951034619581 56.57443350792201 11.951310233041589 79.06906795293851 56.138523444751975 15.857992388018161 87.03605544905288 57.538936402463214 75.50956328599175 12.566545927978723 57.93588160398587 83.53179269184994 86.77654546902642 16.92409745013801 59.98317257598185 44.54534208490363 10.7188315766503 62.31531353815703 9.519434706661434 31.767538976860322 55.1421266632529 50.021063356368686 92.92586701274165 25.881482514676602 4.224983673214988 86.18752951711527 0.36279767203369895 93.44203862627195 2.9622589488566 45.74700037595723 17.2583822251679 93.46216013370497 37.2064515694272 37.35768484618477 98.11695367803746 66.72787107487453 16.31032260338693 55.073225663645964 12.519867875857194 69.69731534203927 6.073541346942612 94.33795093416633 68.76854328223659 75.76722336091663 43.10317934252696 92.76941310188715 52.28772985431157 41.881340354133265 68.4776205746832 64.01255771437532 71.91331833510245 88.21577414259227 82.98149195249131 13.575376250147453 97.34322983502862]
b=3250.9875621190704
sigma=[10.383265368775083, 23.377038847608222, 45.14101545980379, 1.292723491784178, 3.802377760474864, 31.198735958490932, 14.658549272552142, 0.757730334724595, 7.934684604536421, 38.52307077858826, 30.229035170555033, 1.8819547889262582, 14.72166784032876, 23.760369959316645, 27.430100300268048, 4.297765911311384, 45.829675835915815, 1.14941524182568, 32.91571122624648, 5.442963307495941, 50.846494414459066, 4.619263566054056, 29.81216902520306, 25.618896682865522, 6.745812037073139, 19.07205983899779, 1.0699002397162047, 27.280076726708337, 47.06272865037031, 56.19697314553977, 20.053403952574822, 10.35426786877869, 4.697602710029764, 1.0652562986119833, 18.20223275631279, 21.503559886361995, 7.255392659063088, 3.170496694408836, 20.75162645223102, 24.346523223144853, 70.59632948643457, 17.98352467058198, 20.977518822151925, 7.751758144475114, 1.23490165798387, 1.7445432148033369, 21.436052413265624, 0.5184398513814551, 2.0958358892281566, 30.08703666289813, 24.721538404997737, 25.897635571798425, 0.08000001662502806, 55.52648930897068, 9.348883704729502, 11.925441261984563, 43.612496177864344, 9.817651042789185, 12.39916848023758, 52.04466918664284, 40.935059764397664, 63.77764099430104, 14.57327554628545, 45.33437888769901, 5.389498718303169, 62.19387908983415, 19.06077127336902, 15.88541445814202, 10.771899154568711, 18.828828462096443, 41.43211769290071, 27.19722911934656, 23.603506180083674, 27.06062071546473, 6.246058154409388, 4.299031053412334, 1.3557258255683988, 20.637783298893066, 76.63709525493215, 16.258355815018717, 61.97029839514889, 40.59869291249107, 91.91415483215879, 20.823553386739807, 8.26129493656327, 63.750527201566136, 5.104001234235243, 29.174784395189178, 1.3417793449236055, 50.974493895103365, 6.807961342859707, 21.599816047898727, 10.12951407952531, 27.64831437983299, 16.37910580648235, 73.20381415109163, 6.24852210602977, 48.78268993788264, 28.794147191067733, 5.144708273090075, 12.985448409147967, 19.752165545092332, 13.009539031785483, 15.915561670340757, 0.6729811896528397, 41.590148741517496, 91.5955880930206, 1.5597335136577113, 2.336459789921828, 5.7697963006131925, 2.5212688865016797, 39.322814076925496, 51.65730924862792, 1.6572034438018388, 42.54913001682749, 8.404572981383584, 9.363210722317454, 2.835334823352845, 17.766094164925843, 4.183501159739565]
Omega=9.9498743710662




model = Model(optimizer_with_attributes(CPLEX.Optimizer, "CPXPARAM_MIP_Strategy_HeuristicEffort" => 0 , "CPXPARAM_MIP_Strategy_Search" => 1, "CPX_PARAM_CUTSFACTOR" => 1 , "CPXPARAM_Preprocessing_Linear" => 0 , "CPXPARAM_MIP_Interval" => 1))
MOI.set(model, MOI.NumberOfThreads(), 1)
@variable(model, x[1:n] , Bin)
@variable(model, 0 <= y[1:m] <= 1)
@variable(model, c >= 0)
@objective(model, Max, sum(mu[i] * x[i] for i in (1:n)') + sum(mu[100+i] * y[i] for i in (1:m)') - Omega * c)
@constraint(model, sum(a[i] * x[i] for i in (1:n)') + sum(a[100+i] * y[i] for i in (1:m)') <= b)
@constraint(model, c^2 >= (sum(sigma[i]^2 * x[i]^2 for i in (1:n)') + sum(sigma[i+n]^2 * y[i]^2 for i in (1:m)')))

optimize!(model)
print(objective_value(model))